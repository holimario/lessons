# 基带波形实验报告

无04  2019012137  张鸿琳

## 实验目的

- 通过Simulink模块的搭建，理解基带通信系统的各个组成部分。
- 通过实验，理解码间串扰的产生原因及其对抗噪声性能的影响。
- 通过实验，验证无码间串扰、最优接收时的误符号性能。

## 实验内容

- 在AWGN波形信道中传输矩形脉冲并进行匹配滤波接收。
- 在带限AWGN波形信道中观察码间串扰现象，观察功率谱和眼图，测量误符号率。
- 利用根号升余弦滤波器，实现无码间串扰的最优接收。

## 实验原理

### 1. 匹配滤波——最优接收

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/1.png" alt="1" style="zoom:50%;" />

​		电平由波形承载，用电平的冲激串卷积（调制）脉冲成型滤波器。在接受机处，为了尽可能收集信号能量，降低噪声的影响，采用匹配滤波+采样然后判决。

### 2. Nyquist 准则——无码间串扰

​		根据Nyquist准则，若满足无码间串扰(Inter-Symbol Interference)，则给定符号率$R_S$下最少使用带宽$W=R_S/2$，此时脉冲波形的频域为理想低通，但理论上不可实现只能近似。在本次实验中，我们用Passband Frequency（通带频率）和Stopband Frequency（阻带频率)刻画低通滤波器的频率响应。

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/2.png" alt="2" style="zoom: 33%;" />

​		一种实用的脉冲成型滤波器是根号升余弦（Raised Cosine）滤波器，这是一种实用的脉冲成型滤波器，滚降系数一般取$\alpha\in[0.3,0.7]$。为实现匹配滤波，在升余弦$H(f)$的基础上发送滤波器和接收滤波器分别取根号。$\alpha$越大，物理实现越容易，但频谱效率降低。

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/3.png" alt="3" style="zoom: 67%;" />

​		**眼图**：将接收处匹配滤波后的信号叠加，即为眼图（Eye Diagram）。眼图在时域体现码间串扰，若存在码间串扰，则在匹配滤波后的采样点（眼睛张开最大点）的取值更广，从而降低噪声容限，使得抗噪声性能下降。

### 3. 带限信道

​		现实中的信道是**带限的**（Band-limited）。因为往往需要在不同的频段同时传输信号，且避免与其他频段互相干扰，所以在发射机、接收机处都需要对信号进行滤波。

​		本次实验考虑基带信号，由于信道带宽的限制，脉冲相当于受到平滑处理，一些脉冲波形也因此更容易产生符号间串扰（例如矩形脉冲）。

## 实验过程与记录

### 矩形脉冲幅度调制

​		搭建如下仿真模型：

![4](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/4.png)

​		运行仿真，观察并记录示波器在一小段时间内的图像，如下图：

![5](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/5.png)

​		可以看到，调制时，发送端按照输入的01序列输出相应的矩形脉冲，矩形脉冲序列通过信道后，噪声几乎把原信号完全淹没，但是通过匹配滤波，噪声几乎被消除，匹配滤波后按照符号速率$R_S$的频率对波形进行采样，若采样大于0则判定接收到一个1，若采样小于0则判定接收到一个0，这就是调制、解调（匹配采样）的大致过程。（可确定发送波形与判决符号的延时为1个采样点）

​		此后不断改变 AWGN 信道的信噪比$E_S/\sigma^2$，计算出相应信号功率和噪声功率（噪声功率$\sigma^2=\frac{E_S}{E_S/n_0}\frac{f_s}{2}$，在本次仿真中$E_S=1/R_S$，且$f_s=10^5$，$R_S=10^3$，设信噪比$E_S/\sigma^2$为$x dB$，那么$\sigma^2=\frac{f_s}{2R_S\cdot 10^{x/10}}=50\cdot10^{-x/10}$，），仿真并记录相应的误符号率，得到下表：

<table>
    <tr>
        <th style="text-align: center;">信号功率</th>
        <th colspan="5" style="text-align: center;">1</th>
    </tr>
    <tr>
        <th style="text-align: center;">信噪比(dB)</th>
        <th style="text-align: center;">-10</th>
        <th style="text-align: center;">-5</th>
        <th style="text-align: center;">0</th>
        <th style="text-align: center;">5</th>
        <th style="text-align: center;">10</th>
    </tr>
    <tr>
        <th style="text-align: center;">噪声功率</th>
        <th style="text-align: center;">500</th>
        <th style="text-align: center;">158.11</th>
        <th style="text-align: center;">50</th>
        <th style="text-align: center;">15.81</th>
        <th style="text-align: center;">5</th>
    </tr>
    <tr>
        <th style="text-align: center;">误符号率</th>
        <th style="text-align: center;">0.3308</th>
        <th style="text-align: center;">0.213</th>
        <th style="text-align: center;">0.0775</th>
        <th style="text-align: center;">0.0058</th>
        <th style="text-align: center;">0</th>
    </tr>
</table>

​		理论上，在最优接收（匹配滤波）下，对于二元双极性 PAM ，误符号率与信噪比$E_S/n_0$的关系为$P_e=Q(\sqrt{2E_S/n_0})$，对比实验测得误符号率和理论误符号率，得到下表：

|    信噪比(dB)    |    -10     |     -5     |     0      |     5      |     10      |
| :--------------: | :--------: | :--------: | :--------: | :--------: | :---------: |
| **实验误符号率** | **0.3308** | **0.213**  | **0.0775** | **0.0058** |    **0**    |
| **理论误符号率** | **0.3274** | **0.2132** | **0.0786** | **0.0060** | **3.87e-6** |

​		可见实验测得误符号率和理论误符号率十分吻合。



### 带限 AWGN 信道

​		搭建如下仿真模型：

![6](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/6.png)

​		运行仿真，观察示波器图像，并截取一小段时间的波形，如下图：

![7](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/7.png)

​		对比此前未经过低通滤波器的匹配滤波结果，可以发现加入低通滤波器后，匹配滤波的波形的毛刺少了一些，显得更为平滑。

​		再观察功率谱图像，如下：

![8](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/8.png)

​		可见低通滤波器将基带信号的高频组分大大降低，而基带信号的低频部分（<500Hz）基本都得以保留。

​		此后将 AWGN 模块和低通模块“注释直通”，运行仿真观察理想眼图，如下：

![9](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/9.png)

​		在理想眼图中，可观察到三个眼镜，在抽样点完全睁眼，抽样点噪声容限为1，没有ISI导致失真的情况。再取消注释低通滤波器，观察有ISI的眼图，如下：

![10](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/10.png)

​		将眼图设置中“symbols per trace”改为2，打开“眼图测量”再次仿真，可以得到最佳采样时间约为0.275ms，ISI导致的峰值失真约为0.51V，最佳抽样点噪声容限约为0.53V，无差错抽样域约为0.75ms。

​		再取消注释AWGN模块，观察由ISI和噪声共同影响的眼图，如下：

![11](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/11.png)

​		由于噪声的影响，几乎快无法分辨出眼图中的眼睛。

​		最后不断修改AWGN信道的信噪比$E_S/n_0$，运行仿真并记录误符号率，与此前非带限AWGN信道的误符号率进行对比，得到下表：

|    $E_S/n_0$（dB）     |    -10     |     -5     |     0      |      5      |      10      |
| :--------------------: | :--------: | :--------: | :--------: | :---------: | :----------: |
|   **误符号率$P_S$**    | **0.3644** | **0.2669** | **0.1529** | **0.03732** | **0.003102** |
| **最优接收的误符号率** | **0.3308** | **0.213**  | **0.0775** | **0.0058**  |    **0**     |

​		可见带限AWGN信道的误符号率相较于非带限AWGN信道的误符号率有所上升，这是因为频域有限意味着时域无限，也就是说带限信道带来了较为明显的码间串扰（此前的眼图可以印证），且低通滤波也降低了信号的功率，使得信噪比上升，引起误符号率上升。



### 根号升余弦滤波器

​		搭建如下仿真模型：

![12](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/12.png)

​		在配置完成后，通过View Filter Response查看Raised Cosine Transmit Filter模块的“群延迟响应”为500个采样数，再查看Lowpass Filter模块的“群延迟响应”为1059.5个采样数，最后查看Raised Cosine Receive Filter模块的“群延迟响应”为500个采样数。据此修改Pulse Generator模块的相位延时为59。

​		运行仿真，估计出调制信号的功率值约为0.01W，据此修改AWGN信道的输入信号功率。

​		先将AWGN信道注释直通，运行仿真，观察示波器图像，如下图：

![13](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/13.png)

​		由上图可以看出，整个调制、解调（匹配采样）的过程大致为：输入的一系列序列经过升余弦发射滤波器后，变为一系列脉冲的叠加，该信号经过信道，来到接收端，通过升余弦接收滤波器后，再进行采样与判决，从而解码出发射端发出的信号。相较于此前的两个部分的实验的波形，从直观来看，基本没有符号间串扰，这就是升余弦调制、解调的优良性质。（判决符号与发送符号的延时为21个采样点）

​		利用示波器观察升余弦基带信号和带限接收信号的功率谱，如下：

![14](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/14.png)

​		上图可验证升余弦信号的绝大部分能量在信道中被传输。

​		保持AWGN信道模块注释直通，运行仿真，观察眼图，如下：

![15](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/15.png)

​		由上图可知，不存在ISI。从图中读出最佳采样时间约为0.592ms，由ISI导致的峰值失真为0V，最佳抽样点噪声容限约为1V，无差错抽样域约为0.8ms。

​		取消AWGN信道模块的注释，将其信噪比改为参数“SNR”，并在误符号率计算模块后添加To Workspace模块，最后补全“exp7.m”脚本中相应代码，如下：

```matlab
for i = 1:length(SNR_list)
    SNR = SNR_list(i); % in dB
    simOut = sim('myexp7_3');
    ser_rc(i) = simOut.ser(1);
    ser_th(i) = qfunc(sqrt(2*10^(SNR/10)));% TODO
end
```

​		运行脚本，绘制误符号率—信噪比曲线，如下：

![16](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/16.png)

​		可见实验测得值与理论值十分吻合。



## 实验思考题

**1. 基带脉冲波形采用（时域）矩形脉冲与sinc波形（频域为矩形）是否实际可行？为什么？**

​		实际不可行，因为矩形脉冲的频域展宽为无穷大，基本不存在可以传输无穷大频域展宽的信道，而sinc波形在频域上是矩形，不存在缓冲区域（过渡带），在工程上也基本是无法实现的。

**2. 请通过View Filter Response观察根号升余弦滤波器冲激响应，解释为什么在采样数100的倍数处不为0？**

​		根号升余弦滤波器的冲激响应如下：

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C7/%E5%AE%9E%E9%AA%8C7%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/17.png" alt="17" style="zoom: 50%;" />

​		由上图可知在采样数100的倍数处冲激响应不为0。从理论上分析，根号升余弦滤波器的冲激响应为$p(t)=\frac{1}{\sqrt{T_s}}\frac{\sin(\pi(1-\alpha)\frac{t}{T_s})+\frac{4\alpha t}{T_s}\cos(\pi(1+\alpha)\frac{t}{T_s})}{\frac{\pi t}{T_s}[1-(\frac{4\alpha t}{T_s})^2]}$，当符号周期为$T_s=10^{-3}s$，采样周期为$T=10^{-5}s$，滚降系数为$\alpha=0.5$时，则$p(100kT)=\frac{1}{\sqrt{T_s}}\frac{\sin(\frac{1}{2}k\pi)+2k\cos(\frac{3}{2}k\pi)}{k\pi(1-4k^2)}$，可见无论$k$取何值，$\sin(\frac{1}{2}k\pi)$与$\cos(\frac{3}{2}k\pi)$总有一个非零，所以在采样点数100的倍数处冲激响应不为0。

**3. 在5.2节实验的基础上，如果改变带限信道的带宽，会发生什么变化？如果带宽增加到0.75kHz（与5.3节相同）能否近似保证采样点无失真？**

​		如果增大带限信道的带宽，则发送信号会更接近矩形脉冲，从而减小码间串扰；若果减小带限信道的带宽，则发送信号相较于理想矩形脉冲的失真更为严重，码间串扰增加。

​		如果带宽增加到$0.75kHz$，可以近似保证采样点无失真，因为从前面测得的频谱可知，矩形脉冲的频谱能量主要就集中于$[-0.75kHz,0.75kHz]$内。
