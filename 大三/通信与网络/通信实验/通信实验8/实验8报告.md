# 载波传输实验报告

无04  2019012137  张鸿琳

## 实验目的

- 通过Simulink模块的搭建，理解频带传输的方法。
- 通过实验，对比不同的复电平映射方式及其抗噪声性能。
- 通过Simulink模块的搭建，理解一个完整的通信系统的组成部分。

## 实验内容

- 利用多进制相位偏移调制（M-PSK）实现载波传输系统。
- 在复电平信道抽象中，对比M-PSK和M-QAM两种星座映射的误比特率和星座图。
- 搭建一个包括信道编码、基带调制/解调、频带调制/解调的完整通信系统。

## 实验原理

### 1. 载波传输

​		由于通信信道往往是带通的，基带信号需要乘以$\cos(2\pi f_ct)$搬移到频带上再进行传输，其中$f_c$为高频载波，过程如下：

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/1.png" alt="1" style="zoom:50%;" />

​		由于正交性，可以采用两个正交基$\cos(2\pi f_ct)$和$\sin(2\pi f_ct)$同时传输 I 路、 Q 路两路信息，如下图。两路信息用复数表示。

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/2.png" alt="2" style="zoom:50%;" />

​		其中用于频带解调的低通滤波器可以忽略，因为基带解调的匹配滤波已包含其作用。

### 2. 等效复电平信道

​		对于理想的载波传输和基带调制，载波传输过程可等效为复电平信道，等效于发送复数电平，信道为复高斯噪声$CN(0,n_0)$。

### 3. 两种典型载波传输方式

a) 相位偏移调制（PSK: Phase Shift Keying），通过改变载波的相位调制信息。

b) 正交幅度调制（QAM: Quadrature Amplitude Modulation），通过改变载波的相位和幅度调制信息。

​		

## 实验过程与记录

### 多进制相位偏移调制（M-PSK）

​		搭建如下仿真模型：

![3](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/3.png)

​		在Matlab基础工作区给相应变量赋值，使得整个模型进行QPSK调制和解调。将AWGN信道模块注释直通，运行仿真，观察一小段时间内的示波器（Scope）图像，如下：

![4](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/4.png)

​		由上图可知，载波调制与解调过程大致为：首先将每两个比特序列（设置$k=2$）映射为复电平（对应于上图 Tx Baseband中的蓝线和黄线，由上图可知，复电平的模为$(\frac{\sqrt{2}}{2})^2+(\frac{\sqrt{2}}{2})^2=1$，这是PSK的性质），然后复电平信息又分别被加载到正弦波和余弦波上（以相位的形式），形成Tx Passband中的信号，也就是在输入信道的信号，经过信道后（由于AWGN信道被注释直通，所以没有噪声），先将信号分别乘以正弦波和余弦波，再取移动平均，这相当于用正弦波和余弦波分别进行匹配滤波，对滤波结果按照符号周期进行采样，就可以解调出发送的信息了（上图中，依次发送的序列为00、11、00、10，而Baseband Demodulating中相应位置的采样结果恰与之对应）。

​		观察另一个示波器（Scope1）的图像，如下：

![5](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/24.png)

​		可以看到当复电平相位为$-\frac{\pi}{4}$时，载波相位也为$-\frac{\pi}{4}$，而当复电平相位为$\frac{\pi}{4}$时，载波相位也为$\frac{\pi}{4}$，进一步观察其他对应位置，确定复电平相位就等于载波相位。再查看输入符号和电平映射规则如下：

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/19.png" alt="19" style="zoom: 50%;" />

​		综上，待调制的复电平的相位就等于载波相位，更具体地说，比特信息与其映射的复电平相位的对应关系为“00”$\to$$\frac{\pi}{4}$，“11”$\to-\frac{3\pi}{4}$，“10”$\to-\frac{\pi}{4}$，“01”$\to\frac{3\pi}{4}$，而复电平的相位信息又被作为载波相位加载到载波上。进而可得载波信号$y(t)=\cos(2\pi f_ct+\theta)$中$f_c=10000Hz$，$\theta=\pm\frac{\pi}{4}$或$\pm\frac{3\pi}{4}$，$\theta$的具体取值取决于前面的对应关系。（发送比特流与判决比特流的延时为$2k$个采样点，当$k=2$时，延时即为$4$个采样点）

​		观察基带信号、频带调制信号、频带解调过程、基带解调过程的功率谱，如下图：

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/6.png" alt="6" style="zoom:67%;" />

​		显然Tx Baseband的功率集中在基频部分（矩形波脉冲叠加），而在复电平的实部乘以余弦、虚部乘以正弦并求和后，得到Tx Passband的频带被偏移到$-10kHz$和$10kHz$附近，这是因为所用正余弦信号的频率为$f_c=10kHz$，而发送信号的实部与虚部是相互独立的，且分布一致，假设二者的自相关函数都为$R(\tau)$，则经过正余弦信号调制后，Tx Passband信号的自相关函数为$R_1(\tau)=E\{[x_I(t+\tau)\cos(\omega_c(t+\tau))+x_Q(t+\tau)\sin(\omega_c(t+\tau))][x_I(t)\cos(\omega_c(t))+x_Q(t)\sin(\omega_c(t))]\}\\=\frac{1}{2}R(\tau)(\cos(\omega_c(2t+\tau))+\cos(\omega_c\tau))+\frac{1}{2}R(\tau)(-\cos(\omega_c(2t+\tau))+\cos(\omega_c\tau))=R(\tau)\cos(\omega_ct)$，所以经过调制后原功率谱密度被$\cos(2\pi f_ct)$搬移到$\pm f_c$附近（未简便未加入振幅）。然后在接收端，信号被再次乘以正余弦函数并复原为复信号，假设接收端收到信号为$y(t)$，则上述操作相当于$y(t)\cdot\exp(j2\pi f_ct)$，也就是将Tx Passband的频域（功率谱密度）右移$f_c$，故而正如上面Passband Demodulating功率谱密度所示，橙色线的能量集中于$0kHz$和$-20kHz$附近，这就是频移的结果。而通过移动平均模块的信号的功率谱密度就是上图中的蓝线Baseband Demodulating，可以看到相对于橙线Passband Demodulating，其$-20kHz$的频段的功率谱密度被大大压低，这是因为移动平均具有低通滤波器的作用。

​		取消AWGN信道模块的注释，并设置星座图模块，运行仿真，观察信噪比为$10dB$时接收星座点分布，如下：

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/7.png" alt="7" style="zoom:33%;" />

​		可以看到，接收到的星座点集中在理论上的四个星座点附近。

​		对仿真模型稍作修改，增加一个复电平等效信道分支，记录不同信噪比下的两种信道误比特率，与理论值比较，得到下表：

|   $E_b/n_0$（dB）   |     -5     |      0      |      5       |
| :-----------------: | :--------: | :---------: | :----------: |
|  **误比特率$P_b$**  | **0.2127** | **0.08072** | **0.006202** |
| **复电平等效$P_b$** | **0.2053** | **0.08021** |  **0.0048**  |
|  **理论值$P_b$ **   | **0.2132** | **0.0786**  |  **0.0060**  |

​		QPSK的误比特率与信噪比$E_b/n_0$的理论关系为$P_b=\frac{2}{\log_2(M)}Q(\sin(\frac{\pi}{M})\sqrt{2\log_2(M)E_b/n_0})=Q(\sin(\frac{\pi}{4})\sqrt{4E_b/n_0})$，对比上表中实验测得值与理论值，可见实验与理论十分吻合。上述结果说明，QPSK编解码通过一个单个比特信噪比为$E_b/n_0$的信道等效于一个复电平信道（两个独立的单个比特信噪比均为$E_b/n_0$的信道）。



### 复电平映射方式对比

​		搭建如下仿真模型：

![8](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/8.png)

​		设置$E_b/n_0$为20，运行仿真，得到如下接收星座图：

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/9.png" alt="9" style="zoom: 33%;" />

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/10.png" alt="10" style="zoom:33%;" />

​		再设置$E_b/n_0$为10，运行仿真，得到如下接收星座图：

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/11.png" alt="11" style="zoom:33%;" />

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/12.png" alt="12" style="zoom:33%;" />

​		可以看到，当$E_b/n_0=10$时，16-PSK的接收星座图几乎已经无法分辨各个星座点，而16-QAM还可以较为清楚地区分出各个星座点之间的界限，所以从直观来看，16-QAM的抗噪声性能比16-PSK更好。

​		补全“exp8.m”脚本，如下：

```matlab
for i = 1:length(k_list)
    for j = 1:length(SNR_list)
        k = k_list(i);
        M = M_list(i);
        SNR = SNR_list(j); % in dB
        simOut = sim('myexp8_2');
        ber_psk(i,j) = simOut.ber_psk(1);
        ber_qam(i,j) = simOut.ber_qam(1);
        SNR_mag = 10^(SNR/10);
        ber_psk_th(i,j) = 2/log2(M)*...
            qfunc(sin(pi/M)*sqrt(2*log2(M)*SNR_mag));% TODO
        ber_qam_th(i,j) = 4/log2(M)*(1-1/sqrt(M))*...
            qfunc(sqrt(3*log2(M)/(M-1)*SNR_mag));% TODO
    end
end
```

​		运行脚本，得到如下误比特率曲线：

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/13.png" alt="13" style="zoom: 67%;" />

​		可以看到当大部分实验值和理论值都十分吻合，只是对于64-PSK，当信噪比$E_b/n_0$较低时，其误比特率实验值和理论值有较为明显的误差，这是因为理论上认为误比特率$P_b$和误符号率$P_e$在格雷编码下的关系近似为$P_b=\frac{1}{\log_2M}P_e$，而实际上在$M$较大时，一个符号被误判为邻近的第$k$个符号的概率约为$P_k\approx2Q(\sin(\frac{k\pi}{M})\sqrt{\frac{E_b\log_2M}{\sigma^2}})$，可见当$M$较大，$E_b/n_0$较低时，一个符号被误判为邻近第$k$个符号的概率大大增加，也就是说一个错误符号很可能对应于多个错误比特，此时$P_b>\frac{1}{\log_2M}P_e$，也就像上图所显示的那样，对于64-PSK，当$E_b/n_0$较低时，实验测得误比特率大于理论误比特率。



### 综合实验：完整通信系统搭建

​		我设计的完整通信系统如下：

![14](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/20.png)

​		上述通信系统使用(7,4)Hamming码进行编码，编码后再用16-QAM进行符号映射，将比特信号转化为复信号，由于符号率固定为$R_S=1kHz$，可以推知比特率为$R_b=\frac{4}{7}\cdot\log_2(16)\cdot R_S\approx2.286kbps>2.1kbps$，满足要求。

​		映射为复信号后，使用带宽$W=\frac{1+\alpha}{2}R_S=0.75R_S=0.75kHz$（滚降系数$\alpha=0.5$）的根号升余弦滤波器进行发送（模型中的低通滤波器印证了带宽要求），再利用频率为$f_c=10kHz$的正余弦信号，将信号调制到$f_c=10kHz$附近，此时发送信号占用的频段为$[9.25kHz,10.75kHz]$。

​		信号经过信噪比$E_S/n_0$为$12dB$的AWGN信道，用相应频率的正余弦信号进行解调制，再通过根号升余弦接收滤波器进行匹配滤波，在滤波出的波形的相应位置进行采样，将采样结果通过16-QAM逆映射，得到比特序列，最后经过(7,4)Hamming码解码即可。

​		首先可以通过Power Meter模块验证发送的信号的功率，如下：

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/15.png" alt="15" style="zoom: 50%;" />

​		可见发送信号的功率基本为1W。（可利用 Find Delay 模块测得原比特流与经过信道并解码得到的比特流的延时为36）

​		在信道信噪比$E_S/n_0=12dB$时，从理论上分析可以得到上面系统的理论误比特率范围，先把在(7,4)Hamming编解码之间等效为一个信道，则该等效信道的误比特率为$P_{b1}=\frac{4}{\log_2(M)}(1-\frac{1}{\sqrt{M}})Q(\sqrt{\frac{3}{M-1}\cdot\frac{E_S}{n_0}})$$=\frac{4}{4}(1-\frac{1}{4})Q(\sqrt{\frac{3}{15}\cdot10^{12/10}})\approx0.75Q(1.78)\approx0.0281$，再考虑(7,4)Hamming编解码，则整个系统的误块率约为$P_e\approx C_7^2P_{b1}^2(1-P_{b1})^5\approx0.01438$，而误比特率$\frac{P_e}{4}<P_b<P_e$，即$0.00360<P_b<0.01438$，可知理论上该系统存在满足$P_b<0.01$要求的可能（$0.01$包含在$(0.00360,0.01438)$区间内），再利用仿真模型验证该系统确实满足要求，设置AWGN信道信噪比$E_S/n_0=12dB$，实验得到此时该系统误比特率如下：

<img src="C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/23.png" alt="16" style="zoom: 67%;" />

​		该系统误比特率$P_b\approx0.005872<0.01$，满足要求。

​		截图记录信源比特流、信道编码后、基带调制后、频带调制后波形，如下：

![17](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/21.png)

​		截图记录基带调制后、频带调制后、经过信道后、频带解调后的功率谱，如下：

![18](C:/Users/%E6%83%A0%E6%99%AE/Desktop/%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C8/%E5%AE%9E%E9%AA%8C8%E6%8A%A5%E5%91%8A%E5%9B%BE%E7%89%87/22.png)

​		从上图可以看出，设计的通信系统在频谱（功率密度谱）上是满足要求的。



## 实验思考题

**1. 将频带传输等效为复电平信道需要哪些理想假设？请尽可能多列举。**

​		需要如下理想假设：

- 假设基带信号的傅里叶变换为$\mathcal{F}\{p(t)\}=\hat p(f)$，符号周期为$T_s$（符号频率为$R_s$），设$H(f)=|\hat p(f)|^2$，则应满足$\sum\limits_{n=-\infty}^{+\infty}H(f+nR_s)=T_s$
- 基带信号$p(t)$的频域$\hat p(f)$带限于$W$，即$\forall|f|>W$，有$\hat p(f)=0$，且$p(t)$与$\sin(2\pi f_ct)$和$\cos(2\pi f_ct)$频域正交
- 信道噪声满足零均值高斯分布

**2. 在完成了通信部分的实验后，你有什么收获和建议？**

​		完成通信部分的实验后，感觉收获颇丰，对一些理论层面的结论有了更深刻的认识，从最开始的差错控制到电平信道，再到波形信道，最后到载波传输，这些层层递进的知识被实验很好地串联在一起了，让我印象最深的就是最后在综合实验中将此前所学的各个单元的内容组合起来，搭建出了一个完整可通信的系统，成就感十足。

​		最后提一点小建议是：希望能把通信实验的任务留在课下，在课上留出更多的时间用于理论讲授，这样就可以多讲一些实际的应用例子，因为感觉占用课上时间来做实验效率并不是很高（不过在课上对实验内容做一个大概介绍还是有必要的）。
